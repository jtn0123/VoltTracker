# Pre-commit Hooks Setup

Pre-commit hooks are now configured to catch CI failures before you commit.

## What Gets Checked

The following checks run automatically on every commit:
- **Black**: Python code formatting (line length: 120)
- **isort**: Import sorting
- **flake8**: Linting (matches CI config)
- **mypy**: Type checking (matches CI config with all disabled error codes)
- **bandit**: Security scanning (skips B101 like CI)
- **General checks**: trailing whitespace, YAML/JSON validation, large files, private keys, merge conflicts

## Installation

Already installed! The hooks were set up with:
```bash
pip install -r receiver/requirements-dev.txt
pre-commit install
```

## Usage

### Normal commits
Just commit as usual. The hooks run automatically:
```bash
git commit -m "Your message"
```

### Skip hooks (when needed)
If you need to commit without running hooks:
```bash
git commit --no-verify -m "Your message"
```

### Skip specific hooks
```bash
SKIP=mypy git commit -m "Your message"
SKIP=flake8,mypy git commit -m "Your message"
```

### Run hooks manually
Test all hooks on all files:
```bash
pre-commit run --all-files
```

Run hooks on specific files:
```bash
pre-commit run --files receiver/app.py
```

## Optional: Enable Quick Tests

To also run quick tests before commits, uncomment the pytest section at the bottom of `.pre-commit-config.yaml`. Note: This adds ~5-10s to each commit.

## Updating Hooks

Update to latest hook versions:
```bash
pre-commit autoupdate
```

## Notes

- Hooks match CI configuration to catch issues early
- Not 100% strict - focused on catching obvious problems
- You can always use `--no-verify` if hooks are blocking valid commits
- Coverage checks (80% minimum) still only run in CI since they're slower
